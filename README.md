# Deltaton Platform Interaction Documentation
The Deltaton platform offers two primary interaction methods along with the web and mobile apps.
1. **MCP API** - A REST API interface for interacting with Deltaton agents via HTTP requests
2. **Data Feed** - Real-time data streaming (feeding data) to Deltaton via WebSocket, enabling direct agent interaction on the platform

## Base URL
`https://api.deltaton.com`

## Agent Types
Deltaton supports 7 specialized agent types. When an endpoint requires the `agentType` property in the request body, use one of the following values:

| Agent Type | Description | Common Use Cases |
|------------|-------------|------------------|
| `bee` | Bee Agent | Beekeeping management, colony health monitoring |
| `fruitgrowing` | Fruit Growing Agent | Orchard management, fruit crop optimization |
| `general` | General Agent | Broad agricultural queries, basic farm management |
| `greenhouse` | Greenhouse Agent | Climate control, indoor crop management |
| `irrigationfertilization` | Irrigation and Fertilization Agent | Water management, nutrient planning |
| `plantprotection` | Plant Protection Agent | Disease prevention, pest control strategies |
| `viticulture` | Viticulture Agent | Vineyard management, wine grape production |

# Data Feeding
The Data Feed system allows real-time data streaming to the Deltaton platform via WebSocket connections. This data serves as context for agent responses, enabling more accurate and personalized recommendations.

## Getting Started with Data Feed
1. Create a Deltaton account at https://deltaton.com
2. Contact Deltaton support (support@deltaton.com) to receive your:
   - `token` - Required for WebSocket authentication
   - `userId` - Your unique identifier

### Feeding Data Structure
The feeding data is stored in a MongoDB database with the following structure:
```javascript
{
  <agentType>: <Your Data>
}
```

Data feeding and updating works similarly to updating data in a MongoDB database. Each time you feed data to the Deltaton platform, you will receive a response containing all your stored data in the following format as an example:
```javascript
{
  success: true,
  message: 'Feed data received successfully',
  data: {
    greenhouse: {
      temperature: 27,
      humidity: 14,
      lastUpdatedAt: '2025-10-19T19:36:45.797Z'  // This is generated by the system.
    }
  }
}
```

### WebSocket Connection
To establish a WebSocket connection with Deltaton, include these required headers:
- `token`: `DeltaFeed <your-token>` - Your unique authentication token
- `userId`: `your-userId` - Your Deltaton user identifier

For complete implementation examples, refer to our sample code:
- [TypeScript Example](https://github.com/deltaton-labs/deltaton-mcp-doc/blob/main/examples/typescript-example.ts)
- [Python Example](https://github.com/deltaton-labs/deltaton-mcp-doc/blob/main/examples/python-example.py)

These examples demonstrate establishing WebSocket connections and streaming data to the Deltaton platform.

# MCP API Documentation
The Deltaton platform features specialized AI agents for different agricultural domains. Each agent operates in its own chat session, allowing for focused interactions and personalized recommendations. To begin using an agent, first create a dedicated session and then engage in conversation through that session.

## Authentication Headers
All HTTPS requests to the API require the following authentication headers:
- `Content-Type: application/json` - Specifies JSON formatted requests
- `deltaton-id: <your-mcp-id>` - Your unique MCP identifier
- `deltaton-key: <your-mcp-key>` - Your MCP authentication key

> **Important**: API requests may take up to 10 seconds to process. Configure your client timeout settings accordingly.

To obtain your `deltaton-id` and `deltaton-key` credentials, please contact our support team at support@deltaton.com.

## Supported Languages
Deltaton provides multilingual support across these languages:

| English | Spanish | French | German | Italian | Portuguese | Russian | Polish | Hungarian |
|---------|---------|---------|---------|---------|------------|---------|---------|-----------|
| `en` | `es` | `fr` | `de` | `it` | `pt` | `ru` | `pl` | `hu` |

| Czech | Slovak | Dutch | Ukrainian | Romanian | Greek |
|-------|--------|------|----------|----------|-------|
| `cs` | `sk` | `nl` | `uk` | `ro` | `gr` |

When making requests that require the `lang` parameter (such as sending messages), specify your desired language using the corresponding language code.
Example: `{ "prompt": "Hello", "lang": "en" }`

## MCP/API Endpoints

### IMPORTANT
Before you start using the endpoints, structure your project so you first create a session and then send messages within that session. Every new message request must include the session ID (`_id`) as a path parameter in the URL. We recommend creating a separate session for each agent. For example, if you're using the General Agent, create its session first and then use that session for all subsequent messages.

### 1. Create a Session
###### `POST /api/mcp/sessions`
This will create a new session for the specified agent and return the created session. You'll need the `_id` property to send messages to this session.

#### Request Body

| Property | Value |
|----------|--------|
| `name` | Name of the session. If not provided, it will be set to 'New Session'. |
| `agentType` | Refer to the table above to set the agent type. |

#### Response
```javascript
{
  _id: '78f15682ba76159d9c57fabc',
  userId: '01ABCED16GYCCKJA06EKCFEB84',
  name: 'New Session',
  agentType: 'general',
  createdAt: '2025-10-16T20:33:06.544Z',
}
```

### 2. Send a Message
###### `POST /api/mcp/{sessionId}/messages`
This will create a new message for the specified session.

#### Request Body
| Property | Value |
|----------|--------|
| `prompt` | (Required) The question you would like to ask the agent. |
| `agentType` | (Required) Must be one of the supported agent types listed above. |
| `context` | (Optional) Any additional data context, which can be stringified JSON, plain text or Markdown text (recommended) including tables. For JSON data, use clear property names (e.g. `{temperature: 25}` instead of `{t: 25}`). |
| `lang` | (Optional) The language code for the question and response. Must be one of the supported languages listed above. Defaults to 'en' if not provided. |

#### Response
```javascript
{
  id: <Unique Message ID>,
  sessionId: <Unique Session ID the message belongs to>,
  content: <The AI response in markdown format>,
  direction: <SENT or RECEIVED>,
  state: <The message status>,
  createdAt: <UTC timestamp the message was created>
}
```

Please group messages by sessionId and sort them by the `createdAt` timestamp if youâ€™re planning to implement a chat interface.

#### Important Notes
- We recommend providing the additional data as a context with every request if the data values are changed or every 10 mesaages as the memory of the agent is limited to 10 messages.
- The response content is in Markdown format, and you may need to render it depending on your development environment.

### 3. Get a List of Sessions
###### `GET /api/mcp/sessions`

### 4. Delete a Session
###### `DELETE /api/mcp/sessions/{sessionId}`

### 5. Get a List of Messages for a Session
###### `GET /api/mcp/sessions/{sessionId}/messages`
